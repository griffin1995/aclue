{"version":3,"sources":["/home/jack/Documents/aclue-preprod/web/src/components/swipe/__tests__/SwipeCard.test.tsx"],"sourcesContent":["import React from 'react';\nimport { render, screen, fireEvent, waitFor } from '@testing-library/react';\nimport { SwipeCard } from '../SwipeCard';\nimport { Product } from '@/types';\n\n// Mock framer-motion\njest.mock('framer-motion', () => ({\n  motion: {\n    div: ({ children, ...props }: any) => <div {...props}>{children}</div>,\n  },\n  useMotionValue: () => ({ set: jest.fn(), get: jest.fn() }),\n  useTransform: () => ({ set: jest.fn(), get: jest.fn() }),\n  useAnimation: () => ({ start: jest.fn(), stop: jest.fn() }),\n}));\n\nconst mockProduct: Product = {\n  id: '1',\n  name: 'Test Product',\n  description: 'A test product description',\n  price: 29.99,\n  currency: 'USD',\n  imageUrl: 'https://example.com/image.jpg',\n  category: 'Electronics',\n  subcategory: 'Gadgets',\n  brand: 'TestBrand',\n  rating: 4.5,\n  reviewCount: 100,\n  availability: 'in_stock',\n  affiliateUrl: 'https://example.com/affiliate',\n  features: ['Feature 1', 'Feature 2'],\n  tags: ['tag1', 'tag2'],\n  priceHistory: [],\n  createdAt: '2024-01-01T00:00:00Z',\n  updatedAt: '2024-01-01T00:00:00Z',\n};\n\nconst mockOnSwipe = jest.fn();\nconst mockOnLike = jest.fn();\nconst mockOnPass = jest.fn();\n\ndescribe('SwipeCard', () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n  });\n\n  it('renders product information correctly', () => {\n    render(\n      <SwipeCard\n        product={mockProduct}\n        onSwipe={mockOnSwipe}\n        onLike={mockOnLike}\n        onPass={mockOnPass}\n      />\n    );\n\n    expect(screen.getByText('Test Product')).toBeInTheDocument();\n    expect(screen.getByText('A test product description')).toBeInTheDocument();\n    expect(screen.getByText('$29.99')).toBeInTheDocument();\n    expect(screen.getByText('TestBrand')).toBeInTheDocument();\n    expect(screen.getByText('4.5')).toBeInTheDocument();\n    expect(screen.getByText('(100 reviews)')).toBeInTheDocument();\n  });\n\n  it('displays product image with correct alt text', () => {\n    render(\n      <SwipeCard\n        product={mockProduct}\n        onSwipe={mockOnSwipe}\n        onLike={mockOnLike}\n        onPass={mockOnPass}\n      />\n    );\n\n    const image = screen.getByAltText('Test Product');\n    expect(image).toBeInTheDocument();\n    expect(image).toHaveAttribute('src', 'https://example.com/image.jpg');\n  });\n\n  it('shows features list when product has features', () => {\n    render(\n      <SwipeCard\n        product={mockProduct}\n        onSwipe={mockOnSwipe}\n        onLike={mockOnLike}\n        onPass={mockOnPass}\n      />\n    );\n\n    expect(screen.getByText('Features:')).toBeInTheDocument();\n    expect(screen.getByText('Feature 1')).toBeInTheDocument();\n    expect(screen.getByText('Feature 2')).toBeInTheDocument();\n  });\n\n  it('renders like and pass buttons', () => {\n    render(\n      <SwipeCard\n        product={mockProduct}\n        onSwipe={mockOnSwipe}\n        onLike={mockOnLike}\n        onPass={mockOnPass}\n      />\n    );\n\n    const likeButton = screen.getByLabelText('Like this product');\n    const passButton = screen.getByLabelText('Pass on this product');\n\n    expect(likeButton).toBeInTheDocument();\n    expect(passButton).toBeInTheDocument();\n  });\n\n  it('calls onLike when like button is clicked', () => {\n    render(\n      <SwipeCard\n        product={mockProduct}\n        onSwipe={mockOnSwipe}\n        onLike={mockOnLike}\n        onPass={mockOnPass}\n      />\n    );\n\n    const likeButton = screen.getByLabelText('Like this product');\n    fireEvent.click(likeButton);\n\n    expect(mockOnLike).toHaveBeenCalledWith(mockProduct);\n  });\n\n  it('calls onPass when pass button is clicked', () => {\n    render(\n      <SwipeCard\n        product={mockProduct}\n        onSwipe={mockOnSwipe}\n        onLike={mockOnLike}\n        onPass={mockOnPass}\n      />\n    );\n\n    const passButton = screen.getByLabelText('Pass on this product');\n    fireEvent.click(passButton);\n\n    expect(mockOnPass).toHaveBeenCalledWith(mockProduct);\n  });\n\n  it('handles keyboard interactions', () => {\n    render(\n      <SwipeCard\n        product={mockProduct}\n        onSwipe={mockOnSwipe}\n        onLike={mockOnLike}\n        onPass={mockOnPass}\n      />\n    );\n\n    const card = screen.getByRole('article');\n    \n    // Test right arrow key (like)\n    fireEvent.keyDown(card, { key: 'ArrowRight', code: 'ArrowRight' });\n    expect(mockOnLike).toHaveBeenCalledWith(mockProduct);\n\n    // Test left arrow key (pass)\n    fireEvent.keyDown(card, { key: 'ArrowLeft', code: 'ArrowLeft' });\n    expect(mockOnPass).toHaveBeenCalledWith(mockProduct);\n  });\n\n  it('shows availability status correctly', () => {\n    render(\n      <SwipeCard\n        product={mockProduct}\n        onSwipe={mockOnSwipe}\n        onLike={mockOnLike}\n        onPass={mockOnPass}\n      />\n    );\n\n    expect(screen.getByText('In Stock')).toBeInTheDocument();\n  });\n\n  it('handles product without features gracefully', () => {\n    const productWithoutFeatures = { ...mockProduct, features: [] };\n    \n    render(\n      <SwipeCard\n        product={productWithoutFeatures}\n        onSwipe={mockOnSwipe}\n        onLike={mockOnLike}\n        onPass={mockOnPass}\n      />\n    );\n\n    expect(screen.queryByText('Features:')).not.toBeInTheDocument();\n  });\n\n  it('handles missing product image gracefully', () => {\n    const productWithoutImage = { ...mockProduct, imageUrl: '' };\n    \n    render(\n      <SwipeCard\n        product={productWithoutImage}\n        onSwipe={mockOnSwipe}\n        onLike={mockOnLike}\n        onPass={mockOnPass}\n      />\n    );\n\n    // Should still render the product name\n    expect(screen.getByText('Test Product')).toBeInTheDocument();\n  });\n\n  it('formats price correctly for different currencies', () => {\n    const eurProduct = { ...mockProduct, price: 25.50, currency: 'EUR' };\n    \n    render(\n      <SwipeCard\n        product={eurProduct}\n        onSwipe={mockOnSwipe}\n        onLike={mockOnLike}\n        onPass={mockOnPass}\n      />\n    );\n\n    expect(screen.getByText('â‚¬25.50')).toBeInTheDocument();\n  });\n\n  it('shows correct rating stars', () => {\n    render(\n      <SwipeCard\n        product={mockProduct}\n        onSwipe={mockOnSwipe}\n        onLike={mockOnLike}\n        onPass={mockOnPass}\n      />\n    );\n\n    // Check for rating display (4.5 stars)\n    const ratingElement = screen.getByText('4.5');\n    expect(ratingElement).toBeInTheDocument();\n  });\n});"],"names":["jest","mock","motion","div","children","props","useMotionValue","set","fn","get","useTransform","useAnimation","start","stop","mockProduct","id","name","description","price","currency","imageUrl","category","subcategory","brand","rating","reviewCount","availability","affiliateUrl","features","tags","priceHistory","createdAt","updatedAt","mockOnSwipe","mockOnLike","mockOnPass","describe","beforeEach","clearAllMocks","it","render","SwipeCard","product","onSwipe","onLike","onPass","expect","screen","getByText","toBeInTheDocument","image","getByAltText","toHaveAttribute","likeButton","getByLabelText","passButton","fireEvent","click","toHaveBeenCalledWith","card","getByRole","keyDown","key","code","productWithoutFeatures","queryByText","not","productWithoutImage","eurProduct","ratingElement"],"mappings":"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"}