{"version":3,"names":["createPostHogConfig","cov_oomj4dixk","f","s","getCommonEventProperties","validateEvent","isDev","_config","config","isDevelopment","isProd","isProduction","baseConfig","api_host","b","posthogHost","ui_host","person_profiles","capture_pageview","capture_pageleave","debug","autocapture","dom_event_allowlist","css_selector_allowlist","element_allowlist","url_allowlist","undefined","session_recording","recordCrossOriginIframes","maskAllInputs","maskInputOptions","password","email","tel","credit_card","maskTextSelector","blockSelector","ignoreClass","collectFonts","inlineStylesheet","disable_session_recording","cross_subdomain_cookie","secure_cookie","respect_dnt","opt_out_capturing_by_default","batch_size","request_timeout_ms","persistence","persistence_name","posthogKey","cookie_name","cookie_expiration","disable_persistence","disable_surveys","enable_recording_console_log","capture_performance","on_xhr_error","failedRequest","console","warn","loaded","posthog","log","mode","distinct_id","get_distinct_id","version","LIB_VERSION","window","addEventListener","event","capture","error_message","message","error_filename","filename","error_lineno","lineno","error_colno","colno","error_stack","error","stack","reason","toString","api_endpoint","decide_endpoint","advanced_disable_decide","disable_external_dependency_loading","bootstrap","distinctID","isIdentifiedID","featureFlags","property_blacklist","sanitize_properties","xhr_headers","mask_all_text","mask_all_element_attributes","_capture_metrics","eventName","properties","length","app_version","environment","timestamp","Date","toISOString","timezone","Intl","DateTimeFormat","resolvedOptions","timeZone","language","navigator","user_agent","userAgent","viewport_width","innerWidth","viewport_height","innerHeight","screen_width","screen","width","screen_height","height","referrer","document","url","location","href"],"sources":["/home/jack/Documents/aclue-preprod/web/src/lib/posthog-config.ts"],"sourcesContent":["import { PostHogConfig } from 'posthog-js';\nimport { config } from '@/config';\n\n// PostHog configuration factory\nexport function createPostHogConfig(): PostHogConfig {\n  const isDev = config.isDevelopment;\n  const isProd = config.isProduction;\n\n  const baseConfig: PostHogConfig = {\n    // API Configuration\n    api_host: isDev ? 'http://localhost:3000' : config.posthogHost || 'https://eu.i.posthog.com',\n    ui_host: config.posthogHost || 'https://eu.i.posthog.com',\n    \n    // Core Features\n    person_profiles: 'identified_only',\n    capture_pageview: false, // Manual pageview tracking for better proxy compatibility\n    capture_pageleave: true,\n    debug: isDev,\n    \n    // Autocapture Configuration\n    autocapture: {\n      dom_event_allowlist: ['click', 'change', 'submit', 'input'],\n      css_selector_allowlist: [\n        '[data-attr]', \n        '[data-testid]', \n        '[data-ph-capture-attribute]',\n        '.btn',\n        '.button',\n        'button',\n        'a[href]',\n        'input[type=\"submit\"]',\n        'input[type=\"button\"]',\n      ],\n      element_allowlist: [\n        'a', 'button', 'form', 'input', 'select', 'textarea', 'label'\n      ],\n      url_allowlist: isDev ? ['localhost:3000'] : undefined,\n    },\n\n    // Session Recording\n    session_recording: {\n      recordCrossOriginIframes: false,\n      maskAllInputs: true,\n      maskInputOptions: {\n        password: true,\n        email: false,\n        tel: true,\n        credit_card: true,\n      },\n      maskTextSelector: '.sensitive, [data-sensitive]',\n      blockSelector: '.block-recording, [data-block-recording]',\n      ignoreClass: 'ph-ignore',\n      collectFonts: false,\n      inlineStylesheet: false,\n    },\n    disable_session_recording: !isProd,\n\n    // Privacy and Security\n    cross_subdomain_cookie: false,\n    secure_cookie: isProd,\n    respect_dnt: true,\n    opt_out_capturing_by_default: false,\n    \n    // Performance\n    batch_size: isDev ? 10 : 50,\n    request_timeout_ms: 30000,\n    \n    // Persistence\n    persistence: 'localStorage+cookie',\n    persistence_name: `ph_${config.posthogKey}_posthog`,\n    cookie_name: `ph_${config.posthogKey}_posthog`,\n    cookie_expiration: 365, // days\n    disable_persistence: false,\n    \n    // Advanced Features\n    disable_surveys: false,\n    enable_recording_console_log: isDev,\n    capture_performance: isProd,\n    \n    // Error Handling\n    on_xhr_error: (failedRequest) => {\n      console.warn('[PostHog] XHR request failed:', failedRequest);\n    },\n    \n    loaded: (posthog) => {\n      console.log('[PostHog] Analytics service loaded successfully', {\n        mode: isDev ? 'development' : 'production',\n        api_host: posthog.config.api_host,\n        distinct_id: posthog.get_distinct_id(),\n        version: posthog.LIB_VERSION,\n      });\n      \n      // Global access for debugging\n      if (isDev) {\n        window.posthog = posthog;\n        console.log('[PostHog] Available globally as window.posthog for debugging');\n      }\n      \n      // Set up error tracking\n      if (isProd) {\n        window.addEventListener('error', (event) => {\n          posthog.capture('javascript_error', {\n            error_message: event.message,\n            error_filename: event.filename,\n            error_lineno: event.lineno,\n            error_colno: event.colno,\n            error_stack: event.error?.stack,\n          });\n        });\n        \n        window.addEventListener('unhandledrejection', (event) => {\n          posthog.capture('unhandled_promise_rejection', {\n            reason: event.reason?.toString(),\n            stack: event.reason?.stack,\n          });\n        });\n      }\n    },\n  };\n\n  // Development-specific overrides\n  if (isDev) {\n    return {\n      ...baseConfig,\n      // Use local proxy endpoints to avoid CORS\n      api_endpoint: '/api/posthog-proxy',\n      decide_endpoint: '/api/posthog-decide',\n      \n      // Development optimizations\n      advanced_disable_decide: false, // Enable feature flags in dev\n      disable_external_dependency_loading: false,\n      bootstrap: {\n        distinctID: undefined,\n        isIdentifiedID: false,\n        featureFlags: {},\n      },\n      \n      // Faster development feedback\n      property_blacklist: [],\n      sanitize_properties: null,\n      xhr_headers: {\n        'X-PostHog-Source': 'aclue-dev',\n      },\n    };\n  }\n\n  // Production-specific configuration\n  return {\n    ...baseConfig,\n    \n    // Production optimizations\n    advanced_disable_decide: false,\n    disable_external_dependency_loading: false,\n    \n    // Enhanced security\n    mask_all_text: false,\n    mask_all_element_attributes: false,\n    \n    // Performance monitoring\n    capture_performance: true,\n    _capture_metrics: true,\n    \n    // Production headers\n    xhr_headers: {\n      'X-PostHog-Source': 'aclue-prod',\n    },\n  };\n}\n\n// PostHog event validation\nexport function validateEvent(eventName: string, properties?: Record<string, any>): boolean {\n  if (!eventName || typeof eventName !== 'string') {\n    console.warn('[PostHog] Invalid event name:', eventName);\n    return false;\n  }\n  \n  if (eventName.length > 200) {\n    console.warn('[PostHog] Event name too long:', eventName);\n    return false;\n  }\n  \n  if (properties && typeof properties !== 'object') {\n    console.warn('[PostHog] Invalid event properties:', properties);\n    return false;\n  }\n  \n  return true;\n}\n\n// Common event properties\nexport function getCommonEventProperties(): Record<string, any> {\n  return {\n    app_version: config.version,\n    environment: config.isDevelopment ? 'development' : 'production',\n    timestamp: new Date().toISOString(),\n    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,\n    language: navigator.language,\n    user_agent: navigator.userAgent,\n    viewport_width: window.innerWidth,\n    viewport_height: window.innerHeight,\n    screen_width: window.screen.width,\n    screen_height: window.screen.height,\n    referrer: document.referrer,\n    url: window.location.href,\n  };\n}"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}