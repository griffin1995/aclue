{"version":3,"sources":["/home/jack/Documents/aclue-preprod/web/src/hooks/useAccessibility.ts"],"sourcesContent":["import { useEffect, useState, useCallback } from 'react';\n\ninterface UseAccessibilityOptions {\n  announcePageChanges?: boolean;\n  enableKeyboardNavigation?: boolean;\n  reducedMotion?: boolean;\n}\n\ninterface UseAccessibilityReturn {\n  isReducedMotion: boolean;\n  announceToScreenReader: (message: string) => void;\n  focusOnElement: (selector: string) => void;\n  trapFocus: (container: HTMLElement) => () => void;\n  getSkipLinks: () => { href: string; label: string }[];\n}\n\nexport function useAccessibility(options: UseAccessibilityOptions = {}): UseAccessibilityReturn {\n  const {\n    announcePageChanges = true,\n    enableKeyboardNavigation = true,\n    reducedMotion = true,\n  } = options;\n\n  const [isReducedMotion, setIsReducedMotion] = useState(false);\n\n  // Check for reduced motion preference\n  useEffect(() => {\n    if (!reducedMotion) return;\n\n    const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');\n    setIsReducedMotion(mediaQuery.matches);\n\n    const handleChange = (event: MediaQueryListEvent) => {\n      setIsReducedMotion(event.matches);\n    };\n\n    mediaQuery.addEventListener('change', handleChange);\n    return () => mediaQuery.removeEventListener('change', handleChange);\n  }, [reducedMotion]);\n\n  // Announce messages to screen readers\n  const announceToScreenReader = useCallback((message: string) => {\n    const announcement = document.createElement('div');\n    announcement.setAttribute('aria-live', 'polite');\n    announcement.setAttribute('aria-atomic', 'true');\n    announcement.setAttribute('class', 'sr-only');\n    announcement.textContent = message;\n\n    document.body.appendChild(announcement);\n\n    // Remove after announcement\n    setTimeout(() => {\n      document.body.removeChild(announcement);\n    }, 1000);\n  }, []);\n\n  // Focus on an element by selector\n  const focusOnElement = useCallback((selector: string) => {\n    const element = document.querySelector(selector) as HTMLElement;\n    if (element) {\n      element.focus();\n      \n      // Scroll into view if needed\n      element.scrollIntoView({\n        behavior: isReducedMotion ? 'auto' : 'smooth',\n        block: 'center',\n      });\n    }\n  }, [isReducedMotion]);\n\n  // Trap focus within a container (for modals, etc.)\n  const trapFocus = useCallback((container: HTMLElement) => {\n    const focusableElements = container.querySelectorAll(\n      'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n    ) as NodeListOf<HTMLElement>;\n\n    const firstElement = focusableElements[0];\n    const lastElement = focusableElements[focusableElements.length - 1];\n\n    const handleTabKey = (event: KeyboardEvent) => {\n      if (event.key !== 'Tab') return;\n\n      if (event.shiftKey) {\n        // Shift + Tab\n        if (document.activeElement === firstElement) {\n          lastElement.focus();\n          event.preventDefault();\n        }\n      } else {\n        // Tab\n        if (document.activeElement === lastElement) {\n          firstElement.focus();\n          event.preventDefault();\n        }\n      }\n    };\n\n    const handleEscapeKey = (event: KeyboardEvent) => {\n      if (event.key === 'Escape') {\n        // Close modal or return focus\n        const closeButton = container.querySelector('[data-close]') as HTMLElement;\n        if (closeButton) {\n          closeButton.click();\n        }\n      }\n    };\n\n    document.addEventListener('keydown', handleTabKey);\n    document.addEventListener('keydown', handleEscapeKey);\n\n    // Focus first element\n    if (firstElement) {\n      firstElement.focus();\n    }\n\n    // Return cleanup function\n    return () => {\n      document.removeEventListener('keydown', handleTabKey);\n      document.removeEventListener('keydown', handleEscapeKey);\n    };\n  }, []);\n\n  // Get skip navigation links\n  const getSkipLinks = useCallback(() => {\n    return [\n      { href: '#main-content', label: 'Skip to main content' },\n      { href: '#navigation', label: 'Skip to navigation' },\n      { href: '#footer', label: 'Skip to footer' },\n    ];\n  }, []);\n\n  // Set up keyboard navigation\n  useEffect(() => {\n    if (!enableKeyboardNavigation) return;\n\n    const handleKeyDown = (event: KeyboardEvent) => {\n      // Global keyboard shortcuts\n      if (event.altKey) {\n        switch (event.key) {\n          case 'h':\n            // Alt + H: Go to home\n            event.preventDefault();\n            window.location.href = '/';\n            break;\n          case 'd':\n            // Alt + D: Go to dashboard\n            event.preventDefault();\n            window.location.href = '/dashboard';\n            break;\n          case 's':\n            // Alt + S: Go to search/discover\n            event.preventDefault();\n            window.location.href = '/discover';\n            break;\n          case '/':\n            // Alt + /: Focus search\n            event.preventDefault();\n            focusOnElement('input[type=\"search\"], input[placeholder*=\"search\" i]');\n            break;\n        }\n      }\n\n      // Tab navigation enhancements\n      if (event.key === 'Tab') {\n        // Add visible focus indicators\n        document.body.classList.add('keyboard-navigation');\n      }\n    };\n\n    const handleMouseDown = () => {\n      // Remove keyboard navigation class on mouse use\n      document.body.classList.remove('keyboard-navigation');\n    };\n\n    document.addEventListener('keydown', handleKeyDown);\n    document.addEventListener('mousedown', handleMouseDown);\n\n    return () => {\n      document.removeEventListener('keydown', handleKeyDown);\n      document.removeEventListener('mousedown', handleMouseDown);\n    };\n  }, [enableKeyboardNavigation, focusOnElement]);\n\n  // Announce page changes for screen readers\n  useEffect(() => {\n    if (!announcePageChanges) return;\n\n    const announcePageTitle = () => {\n      const title = document.title;\n      if (title) {\n        announceToScreenReader(`Page loaded: ${title}`);\n      }\n    };\n\n    // Announce initial page load\n    setTimeout(announcePageTitle, 100);\n\n    // Listen for navigation changes (for SPA routing)\n    const handlePopState = () => {\n      setTimeout(announcePageTitle, 100);\n    };\n\n    window.addEventListener('popstate', handlePopState);\n    return () => window.removeEventListener('popstate', handlePopState);\n  }, [announcePageChanges, announceToScreenReader]);\n\n  return {\n    isReducedMotion,\n    announceToScreenReader,\n    focusOnElement,\n    trapFocus,\n    getSkipLinks,\n  };\n}"],"names":["useAccessibility","options","announcePageChanges","enableKeyboardNavigation","reducedMotion","isReducedMotion","setIsReducedMotion","useState","useEffect","mediaQuery","window","matchMedia","matches","handleChange","event","addEventListener","removeEventListener","announceToScreenReader","useCallback","message","announcement","document","createElement","setAttribute","textContent","body","appendChild","setTimeout","removeChild","focusOnElement","selector","element","querySelector","focus","scrollIntoView","behavior","block","trapFocus","container","focusableElements","querySelectorAll","firstElement","lastElement","length","handleTabKey","key","shiftKey","activeElement","preventDefault","handleEscapeKey","closeButton","click","getSkipLinks","href","label","handleKeyDown","altKey","location","classList","add","handleMouseDown","remove","announcePageTitle","title","handlePopState"],"mappings":"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"}